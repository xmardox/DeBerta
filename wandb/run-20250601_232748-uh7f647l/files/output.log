WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tf_keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

All model checkpoint layers were used when initializing TFDebertaModel.

All the layers of TFDebertaModel were initialized from the model checkpoint at microsoft/deberta-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDebertaModel for predictions without further training.
Using cache file path: cache\CSE_CIC_IDS_1300_QdLmZHuh8yOmlGcKBEkf7hepImY0_9Xii0x0FeiUOoDMwEgiWksBPgKc0.feather
Reading directly from cache cache\CSE_CIC_IDS_1300_QdLmZHuh8yOmlGcKBEkf7hepImY0_9Xii0x0FeiUOoDMwEgiWksBPgKc0.feather...
All model checkpoint layers were used when initializing TFDebertaModel.

All the layers of TFDebertaModel were initialized from the model checkpoint at microsoft/deberta-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDebertaModel for predictions without further training.
WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
[1mModel: "functional"[0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1mLayer (type)                 [0m[1m [0m┃[1m [0m[1mOutput Shape             [0m[1m [0m┃[1m [0m[1m        Param #[0m[1m [0m┃[1m [0m[1mConnected to              [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_ids ([38;5;33mInputLayer[0m)        │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ attention_mask ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ deberta ([38;5;33mLambda[0m)              │ ([38;5;45mNone[0m, [38;5;34m768[0m)               │               [38;5;34m0[0m │ input_ids[[38;5;34m0[0m][[38;5;34m0[0m],           │
│                               │                           │                 │ attention_mask[[38;5;34m0[0m][[38;5;34m0[0m]       │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ slice_last ([38;5;33mLambda[0m)           │ ([38;5;34m768[0m)                     │               [38;5;34m0[0m │ deberta[[38;5;34m0[0m][[38;5;34m0[0m]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expand_dims ([38;5;33mLambda[0m)          │ ([38;5;34m1[0m, [38;5;34m768[0m)                  │               [38;5;34m0[0m │ slice_last[[38;5;34m0[0m][[38;5;34m0[0m]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ classification_mlp_0_128      │ ([38;5;34m1[0m, [38;5;34m128[0m)                  │          [38;5;34m98,432[0m │ expand_dims[[38;5;34m0[0m][[38;5;34m0[0m]          │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout ([38;5;33mDropout[0m)             │ ([38;5;34m1[0m, [38;5;34m128[0m)                  │               [38;5;34m0[0m │ classification_mlp_0_128[[38;5;34m…[0m │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ binary_classification_out     │ ([38;5;34m1[0m, [38;5;34m1[0m)                    │             [38;5;34m129[0m │ dropout[[38;5;34m0[0m][[38;5;34m0[0m]              │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
[1m Total params: [0m[38;5;34m98,561[0m (385.00 KB)
[1m Trainable params: [0m[38;5;34m98,561[0m (385.00 KB)
[1m Non-trainable params: [0m[38;5;34m0[0m (0.00 B)
Building eval dataset...
Splitting dataset to featurewise...
Evaluation dataset is built!
Positive samples in eval set: 6
Negative samples in eval set: 20

Traceback (most recent call last):
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\main.py", line 88, in <module>
    (train_results, eval_results, final_epoch) = ft.evaluate(m, batch_size=128, epochs=5, steps_per_epoch=5, early_stopping_patience=5)
                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\framework\flow_transformer.py", line 591, in evaluate
    batch_results = m.train_on_batch(batch_X, batch_y)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 601, in train_on_batch
    logs = self.train_function(data())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 227, in function
    outputs = one_step_on_data(data)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tensorflow\python\util\traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 113, in one_step_on_data
    outputs = self.distribute_strategy.run(step_function, args=(data,))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 57, in train_step
    y_pred = self(x, training=True)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\utils\traceback_utils.py", line 124, in error_handler
    del filtered_tb
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\layers\input_spec.py", line 160, in assert_input_compatibility
    raise ValueError(
ValueError: Layer "functional" expects 2 input(s), but it received 37 input tensors. Inputs received: [<tf.Tensor 'data:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_1:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_2:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_3:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_4:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_5:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_6:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_7:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_8:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_9:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_10:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_11:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_12:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_13:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_14:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_15:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_16:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_17:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_18:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_19:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_20:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_21:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_22:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_23:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_24:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_25:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_26:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_27:0' shape=(128, 8) dtype=float32>, <tf.Tensor 'data_28:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_29:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_30:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_31:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_32:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_33:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_34:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_35:0' shape=(128, 8, 0) dtype=float64>, <tf.Tensor 'data_36:0' shape=(128, 8, 0) dtype=float64>]
[0m
