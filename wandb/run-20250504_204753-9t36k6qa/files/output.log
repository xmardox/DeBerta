Using cache file path: cache\CSE_CIC_IDS_10000_QdLmZHuh8yOmlGcKBEkf7hepImY0_ruPScOm4x0xgzBre0EnuV8Ro2VE0.feather
Reading directly from cache cache\CSE_CIC_IDS_10000_QdLmZHuh8yOmlGcKBEkf7hepImY0_ruPScOm4x0xgzBre0EnuV8Ro2VE0.feather...
c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\implementations\transformers\basic\encoder_block.py:74: UserWarning: Typically inner_dimension should be greater than or equal to the input_dimension!
  warnings.warn(f"Typically inner_dimension should be greater than or equal to the input_dimension!")
WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
[1mModel: "functional"[0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1mLayer (type)                 [0m[1m [0m┃[1m [0m[1mOutput Shape             [0m[1m [0m┃[1m [0m[1m        Param #[0m[1m [0m┃[1m [0m[1mConnected to              [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_MAX_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_128_TO_256_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_OUT_PKTS ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MAX_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_PKTS   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SHORTEST_FLOW_PKT       │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_IN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_256_TO_512_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_LONGEST_FLOW_PKT        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_512_TO_1024_B… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_BYTES  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_1024_TO_1514_… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_FLOW_DURATION_MILLISEC… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_UP_TO_128_BYT… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_IN             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_OUT            │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_PKTS  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_OUT_BYTES ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_BYTES ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_PKTS ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_OUT         │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_CLIENT_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m26[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_SRC_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_FLAGS ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m26[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_IPV4_TYPE          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_TYPE ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_PROTOCOL ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m4[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SERVER_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m23[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_DST_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L7_PROTO ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ concatenate ([38;5;33mConcatenate[0m)     │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │               [38;5;34m0[0m │ input_MAX_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_NUM_PKTS_128_TO_256… │
│                               │                           │                 │ input_OUT_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_MAX_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_RETRANSMITTED_OUT_B… │
│                               │                           │                 │ input_RETRANSMITTED_IN_PK… │
│                               │                           │                 │ input_SHORTEST_FLOW_PKT[[38;5;34m0[0m… │
│                               │                           │                 │ input_TCP_WIN_MAX_IN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_NUM_PKTS_256_TO_512… │
│                               │                           │                 │ input_LONGEST_FLOW_PKT[[38;5;34m0[0m]… │
│                               │                           │                 │ input_NUM_PKTS_512_TO_102… │
│                               │                           │                 │ input_SRC_TO_DST_SECOND_B… │
│                               │                           │                 │ input_RETRANSMITTED_IN_BY… │
│                               │                           │                 │ input_MIN_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_NUM_PKTS_1024_TO_15… │
│                               │                           │                 │ input_FLOW_DURATION_MILLI… │
│                               │                           │                 │ input_MIN_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_NUM_PKTS_UP_TO_128_… │
│                               │                           │                 │ input_SRC_TO_DST_AVG_THRO… │
│                               │                           │                 │ input_DURATION_IN[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_DST_TO_SRC_SECOND_B… │
│                               │                           │                 │ input_DURATION_OUT[[38;5;34m0[0m][[38;5;34m0[0m],  │
│                               │                           │                 │ input_RETRANSMITTED_OUT_P… │
│                               │                           │                 │ input_OUT_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_IN_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_IN_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_DST_TO_SRC_AVG_THRO… │
│                               │                           │                 │ input_TCP_WIN_MAX_OUT[[38;5;34m0[0m][[38;5;34m…[0m │
│                               │                           │                 │ input_CLIENT_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_SRC_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_TCP_FLAGS[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_ICMP_IPV4_TYPE[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_ICMP_TYPE[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_PROTOCOL[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_SERVER_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_DST_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_L7_PROTO[[38;5;34m0[0m][[38;5;34m0[0m]       │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_0_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │         [38;5;34m344,258[0m │ concatenate[[38;5;34m0[0m][[38;5;34m0[0m]          │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │         [38;5;34m344,258[0m │ block_0_transformer_encod… │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ slice_last ([38;5;33mLambda[0m)           │ ([38;5;45mNone[0m, [38;5;34m267[0m)               │               [38;5;34m0[0m │ block_1_transformer_encod… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ classification_mlp_0_128      │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │          [38;5;34m34,304[0m │ slice_last[[38;5;34m0[0m][[38;5;34m0[0m]           │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout_2 ([38;5;33mDropout[0m)           │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │               [38;5;34m0[0m │ classification_mlp_0_128[[38;5;34m…[0m │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ binary_classification_out     │ ([38;5;45mNone[0m, [38;5;34m1[0m)                 │             [38;5;34m129[0m │ dropout_2[[38;5;34m0[0m][[38;5;34m0[0m]            │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
[1m Total params: [0m[38;5;34m722,949[0m (2.76 MB)
[1m Trainable params: [0m[38;5;34m722,949[0m (2.76 MB)
[1m Non-trainable params: [0m[38;5;34m0[0m (0.00 B)
Building eval dataset...
Splitting dataset to featurewise...
Evaluation dataset is built!
Positive samples in eval set: 17
Negative samples in eval set: 183
Epoch = 0 / 5 (early stop in 5), step = 0, loss = 0.61899, results = [array(0.61899346, dtype=float32), array(0.625, dtype=float32)] -- elapsed (train): 0.00s
Epoch = 0 / 5 (early stop in 5), step = 14, loss = 0.39054, results = [array(0.39054218, dtype=float32), array(0.84479165, dtype=float32)] -- elapsed (train): 2.91s
Epoch = 0 / 5 (early stop in 5), step = 31, loss = 0.25219, results = [array(0.25219357, dtype=float32), array(0.9050293, dtype=float32)] -- elapsed (train): 5.81s
Epoch = 0 / 5 (early stop in 5), step = 47, loss = 0.20681, results = [array(0.20681448, dtype=float32), array(0.92594403, dtype=float32)] -- elapsed (train): 8.59s
Epoch = 1 / 5 (early stop in 5), step = 0, loss = 0.17899, results = [array(0.17898802, dtype=float32), array(0.93822116, dtype=float32)] -- elapsed (train): 11.50s
Epoch = 1 / 5 (early stop in 5), step = 16, loss = 0.15934, results = [array(0.15934025, dtype=float32), array(0.94579476, dtype=float32)] -- elapsed (train): 14.34s
Epoch = 1 / 5 (early stop in 5), step = 31, loss = 0.14732, results = [array(0.14732368, dtype=float32), array(0.95092773, dtype=float32)] -- elapsed (train): 17.13s
Epoch = 1 / 5 (early stop in 5), step = 47, loss = 0.13877, results = [array(0.13877134, dtype=float32), array(0.9545201, dtype=float32)] -- elapsed (train): 20.05s
Epoch = 1 / 5 (early stop in 5), step = 62, loss = 0.13092, results = [array(0.13091579, dtype=float32), array(0.9576157, dtype=float32)] -- elapsed (train): 22.85s
Epoch = 2 / 5 (early stop in 5), step = 15, loss = 0.12681, results = [array(0.12680541, dtype=float32), array(0.95985246, dtype=float32)] -- elapsed (train): 25.77s
Epoch = 2 / 5 (early stop in 5), step = 32, loss = 0.12117, results = [array(0.12117476, dtype=float32), array(0.9620536, dtype=float32)] -- elapsed (train): 28.71s
Epoch = 2 / 5 (early stop in 5), step = 49, loss = 0.11707, results = [array(0.11707381, dtype=float32), array(0.96348315, dtype=float32)] -- elapsed (train): 31.64s
Epoch = 3 / 5 (early stop in 5), step = 1, loss = 0.11263, results = [array(0.11262801, dtype=float32), array(0.96524644, dtype=float32)] -- elapsed (train): 34.43s
Epoch = 3 / 5 (early stop in 5), step = 17, loss = 0.10819, results = [array(0.10818954, dtype=float32), array(0.9667411, dtype=float32)] -- elapsed (train): 37.22s
Epoch = 3 / 5 (early stop in 5), step = 32, loss = 0.10553, results = [array(0.10553306, dtype=float32), array(0.96774304, dtype=float32)] -- elapsed (train): 40.01s
Epoch = 3 / 5 (early stop in 5), step = 48, loss = 0.10266, results = [array(0.10266421, dtype=float32), array(0.96868515, dtype=float32)] -- elapsed (train): 42.99s
Epoch = 3 / 5 (early stop in 5), step = 63, loss = 0.10065, results = [array(0.10065131, dtype=float32), array(0.96939087, dtype=float32)] -- elapsed (train): 45.95s
Epoch = 4 / 5 (early stop in 5), step = 14, loss = 0.09848, results = [array(0.09848016, dtype=float32), array(0.9701338, dtype=float32)] -- elapsed (train): 48.69s
Epoch = 4 / 5 (early stop in 5), step = 30, loss = 0.09614, results = [array(0.09614027, dtype=float32), array(0.9706555, dtype=float32)] -- elapsed (train): 51.61s
Epoch = 4 / 5 (early stop in 5), step = 46, loss = 0.09391, results = [array(0.09390672, dtype=float32), array(0.9714831, dtype=float32)] -- elapsed (train): 54.50s
Epoch = 4 / 5 (early stop in 5), step = 62, loss = 0.09211, results = [array(0.09210987, dtype=float32), array(0.9720073, dtype=float32)] -- elapsed (train): 57.40s
[1m7/7[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 105ms/step
Epoch 4 yielded predictions: (200,), overall balanced accuracy: 93.84%, TP = 15 / 17, TN = 182 / 183
train_results: [[array(0.61899346, dtype=float32), array(0.625, dtype=float32), 0, 0], [array(0.91535306, dtype=float32), array(0.625, dtype=float32), 0.45884132385253906, 0], [array(0.829447, dtype=float32), array(0.6276042, dtype=float32), 0.6739327907562256, 0], [array(0.7175143, dtype=float32), array(0.6855469, dtype=float32), 0.8817529678344727, 0], [array(0.6287972, dtype=float32), array(0.725, dtype=float32), 1.0930938720703125, 0], [array(0.5913101, dtype=float32), array(0.73567706, dtype=float32), 1.2909345626831055, 0], [array(0.5591724, dtype=float32), array(0.7488839, dtype=float32), 1.4872279167175293, 0], [array(0.5211273, dtype=float32), array(0.7705078, dtype=float32), 1.694669485092163, 0], [array(0.49152428, dtype=float32), array(0.7907986, dtype=float32), 1.8694188594818115, 0], [array(0.48322836, dtype=float32), array(0.803125, dtype=float32), 2.0449233055114746, 0], [array(0.46051887, dtype=float32), array(0.81392044, dtype=float32), 2.220754861831665, 0], [array(0.44287935, dtype=float32), array(0.81966144, dtype=float32), 2.390228509902954, 0], [array(0.42191416, dtype=float32), array(0.82872593, dtype=float32), 2.564579963684082, 0], [array(0.40603656, dtype=float32), array(0.8370536, dtype=float32), 2.741101026535034, 0], [array(0.39054218, dtype=float32), array(0.84479165, dtype=float32), 2.9123218059539795, 0], [array(0.37477818, dtype=float32), array(0.85253906, dtype=float32), 3.083103656768799, 0], [array(0.36216435, dtype=float32), array(0.8566176, dtype=float32), 3.2523562908172607, 0], [array(0.34852028, dtype=float32), array(0.8628472, dtype=float32), 3.4253435134887695, 0], [array(0.33959025, dtype=float32), array(0.86554277, dtype=float32), 3.5925984382629395, 0], [array(0.330576, dtype=float32), array(0.86992186, dtype=float32), 3.766880512237549, 0], [array(0.3245508, dtype=float32), array(0.87276787, dtype=float32), 3.9366047382354736, 0], [array(0.3158604, dtype=float32), array(0.87677556, dtype=float32), 4.103659629821777, 0], [array(0.30691758, dtype=float32), array(0.88077444, dtype=float32), 4.283281326293945, 0], [array(0.29913995, dtype=float32), array(0.88411456, dtype=float32), 4.451603174209595, 0], [array(0.2928869, dtype=float32), array(0.8865625, dtype=float32), 4.625718832015991, 0], [array(0.28692335, dtype=float32), array(0.8894231, dtype=float32), 4.800174951553345, 0], [array(0.28175074, dtype=float32), array(0.8920718, dtype=float32), 4.969725131988525, 0], [array(0.27412918, dtype=float32), array(0.89564735, dtype=float32), 5.134748935699463, 0], [array(0.26671627, dtype=float32), array(0.8987069, dtype=float32), 5.307722806930542, 0], [array(0.26251915, dtype=float32), array(0.9007813, dtype=float32), 5.472798824310303, 0], [array(0.2577043, dtype=float32), array(0.90272176, dtype=float32), 5.641525030136108, 0], [array(0.25219357, dtype=float32), array(0.9050293, dtype=float32), 5.811978101730347, 0], [array(0.24730347, dtype=float32), array(0.9074337, dtype=float32), 6.012818336486816, 0], [array(0.24240859, dtype=float32), array(0.9094669, dtype=float32), 6.18721866607666, 0], [array(0.23819292, dtype=float32), array(0.9111607, dtype=float32), 6.352494239807129, 0], [array(0.23382348, dtype=float32), array(0.9131944, dtype=float32), 6.5281336307525635, 0], [array(0.23080441, dtype=float32), array(0.9144848, dtype=float32), 6.706010818481445, 0], [array(0.22752436, dtype=float32), array(0.91570723, dtype=float32), 6.879091739654541, 0], [array(0.22479674, dtype=float32), array(0.91686696, dtype=float32), 7.048205137252808, 0], [array(0.22160693, dtype=float32), array(0.91796875, dtype=float32), 7.220047473907471, 0], [array(0.21968779, dtype=float32), array(0.91920733, dtype=float32), 7.387389183044434, 0], [array(0.2180265, dtype=float32), array(0.9203869, dtype=float32), 7.561913728713989, 0], [array(0.21693829, dtype=float32), array(0.92114824, dtype=float32), 7.731269836425781, 0], [array(0.21355592, dtype=float32), array(0.92258525, dtype=float32), 7.905941724777222, 0], [array(0.21082573, dtype=float32), array(0.92395836, dtype=float32), 8.07564306259155
type(train_results): <class 'list'>
eval_results:    epoch   P    N  pred_P  pred_N  TP  FP   TN  FN   bal_acc        f1
0      4  17  183      16     184  15   1  182   2  0.938444  0.909091
type(eval_results): <class 'pandas.core.frame.DataFrame'>

Traceback (most recent call last):
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\mainoriginal.py", line 113, in <module>
    eval_loss = eval_results[0]  # Primero el 'loss'
                ~~~~~~~~~~~~^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 0
