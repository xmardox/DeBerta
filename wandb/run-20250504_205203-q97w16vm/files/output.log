Using cache file path: cache\CSE_CIC_IDS_10000_QdLmZHuh8yOmlGcKBEkf7hepImY0_ruPScOm4x0xgzBre0EnuV8Ro2VE0.feather
Reading directly from cache cache\CSE_CIC_IDS_10000_QdLmZHuh8yOmlGcKBEkf7hepImY0_ruPScOm4x0xgzBre0EnuV8Ro2VE0.feather...
c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\implementations\transformers\basic\encoder_block.py:74: UserWarning: Typically inner_dimension should be greater than or equal to the input_dimension!
  warnings.warn(f"Typically inner_dimension should be greater than or equal to the input_dimension!")
WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
[1mModel: "functional"[0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1mLayer (type)                 [0m[1m [0m┃[1m [0m[1mOutput Shape             [0m[1m [0m┃[1m [0m[1m        Param #[0m[1m [0m┃[1m [0m[1mConnected to              [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_MAX_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_128_TO_256_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_OUT_PKTS ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MAX_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_PKTS   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SHORTEST_FLOW_PKT       │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_IN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_256_TO_512_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_LONGEST_FLOW_PKT        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_512_TO_1024_B… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_BYTES  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_1024_TO_1514_… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_FLOW_DURATION_MILLISEC… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_UP_TO_128_BYT… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_IN             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_OUT            │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_PKTS  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_OUT_BYTES ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_BYTES ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_PKTS ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_OUT         │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_CLIENT_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m26[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_SRC_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_FLAGS ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m26[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_IPV4_TYPE          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_TYPE ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_PROTOCOL ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m4[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SERVER_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m23[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_DST_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L7_PROTO ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ concatenate ([38;5;33mConcatenate[0m)     │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │               [38;5;34m0[0m │ input_MAX_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_NUM_PKTS_128_TO_256… │
│                               │                           │                 │ input_OUT_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_MAX_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_RETRANSMITTED_OUT_B… │
│                               │                           │                 │ input_RETRANSMITTED_IN_PK… │
│                               │                           │                 │ input_SHORTEST_FLOW_PKT[[38;5;34m0[0m… │
│                               │                           │                 │ input_TCP_WIN_MAX_IN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_NUM_PKTS_256_TO_512… │
│                               │                           │                 │ input_LONGEST_FLOW_PKT[[38;5;34m0[0m]… │
│                               │                           │                 │ input_NUM_PKTS_512_TO_102… │
│                               │                           │                 │ input_SRC_TO_DST_SECOND_B… │
│                               │                           │                 │ input_RETRANSMITTED_IN_BY… │
│                               │                           │                 │ input_MIN_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_NUM_PKTS_1024_TO_15… │
│                               │                           │                 │ input_FLOW_DURATION_MILLI… │
│                               │                           │                 │ input_MIN_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_NUM_PKTS_UP_TO_128_… │
│                               │                           │                 │ input_SRC_TO_DST_AVG_THRO… │
│                               │                           │                 │ input_DURATION_IN[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_DST_TO_SRC_SECOND_B… │
│                               │                           │                 │ input_DURATION_OUT[[38;5;34m0[0m][[38;5;34m0[0m],  │
│                               │                           │                 │ input_RETRANSMITTED_OUT_P… │
│                               │                           │                 │ input_OUT_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_IN_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_IN_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_DST_TO_SRC_AVG_THRO… │
│                               │                           │                 │ input_TCP_WIN_MAX_OUT[[38;5;34m0[0m][[38;5;34m…[0m │
│                               │                           │                 │ input_CLIENT_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_SRC_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_TCP_FLAGS[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_ICMP_IPV4_TYPE[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_ICMP_TYPE[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_PROTOCOL[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_SERVER_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_DST_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_L7_PROTO[[38;5;34m0[0m][[38;5;34m0[0m]       │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_0_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │         [38;5;34m344,258[0m │ concatenate[[38;5;34m0[0m][[38;5;34m0[0m]          │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m267[0m)            │         [38;5;34m344,258[0m │ block_0_transformer_encod… │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ slice_last ([38;5;33mLambda[0m)           │ ([38;5;45mNone[0m, [38;5;34m267[0m)               │               [38;5;34m0[0m │ block_1_transformer_encod… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ classification_mlp_0_128      │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │          [38;5;34m34,304[0m │ slice_last[[38;5;34m0[0m][[38;5;34m0[0m]           │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout_2 ([38;5;33mDropout[0m)           │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │               [38;5;34m0[0m │ classification_mlp_0_128[[38;5;34m…[0m │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ binary_classification_out     │ ([38;5;45mNone[0m, [38;5;34m1[0m)                 │             [38;5;34m129[0m │ dropout_2[[38;5;34m0[0m][[38;5;34m0[0m]            │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
[1m Total params: [0m[38;5;34m722,949[0m (2.76 MB)
[1m Trainable params: [0m[38;5;34m722,949[0m (2.76 MB)
[1m Non-trainable params: [0m[38;5;34m0[0m (0.00 B)
Building eval dataset...
Splitting dataset to featurewise...
Evaluation dataset is built!
Positive samples in eval set: 17
Negative samples in eval set: 183
Epoch = 0 / 5 (early stop in 5), step = 0, loss = 0.74153, results = [array(0.7415254, dtype=float32), array(0.5, dtype=float32)] -- elapsed (train): 0.00s
Epoch = 0 / 5 (early stop in 5), step = 15, loss = 0.40056, results = [array(0.40055975, dtype=float32), array(0.8300781, dtype=float32)] -- elapsed (train): 3.04s
Epoch = 0 / 5 (early stop in 5), step = 27, loss = 0.28391, results = [array(0.28390765, dtype=float32), array(0.8858817, dtype=float32)] -- elapsed (train): 6.03s
Epoch = 0 / 5 (early stop in 5), step = 41, loss = 0.22966, results = [array(0.22965556, dtype=float32), array(0.91183037, dtype=float32)] -- elapsed (train): 8.86s
Epoch = 0 / 5 (early stop in 5), step = 54, loss = 0.19905, results = [array(0.19904509, dtype=float32), array(0.92642045, dtype=float32)] -- elapsed (train): 11.62s
Epoch = 1 / 5 (early stop in 5), step = 4, loss = 0.17483, results = [array(0.17482688, dtype=float32), array(0.9369339, dtype=float32)] -- elapsed (train): 14.57s
Epoch = 1 / 5 (early stop in 5), step = 18, loss = 0.16037, results = [array(0.16037266, dtype=float32), array(0.94371235, dtype=float32)] -- elapsed (train): 17.52s
Epoch = 1 / 5 (early stop in 5), step = 33, loss = 0.14646, results = [array(0.14646065, dtype=float32), array(0.94929844, dtype=float32)] -- elapsed (train): 20.35s
Epoch = 1 / 5 (early stop in 5), step = 49, loss = 0.13876, results = [array(0.13875957, dtype=float32), array(0.9527138, dtype=float32)] -- elapsed (train): 23.26s
Epoch = 2 / 5 (early stop in 5), step = 1, loss = 0.13093, results = [array(0.13093077, dtype=float32), array(0.9560096, dtype=float32)] -- elapsed (train): 26.15s
Epoch = 2 / 5 (early stop in 5), step = 17, loss = 0.12498, results = [array(0.12497569, dtype=float32), array(0.9587436, dtype=float32)] -- elapsed (train): 29.05s
Epoch = 2 / 5 (early stop in 5), step = 33, loss = 0.12031, results = [array(0.1203125, dtype=float32), array(0.9611304, dtype=float32)] -- elapsed (train): 31.93s
Epoch = 2 / 5 (early stop in 5), step = 49, loss = 0.11792, results = [array(0.11791743, dtype=float32), array(0.9624737, dtype=float32)] -- elapsed (train): 34.83s
Epoch = 3 / 5 (early stop in 5), step = 1, loss = 0.11559, results = [array(0.11559367, dtype=float32), array(0.9635954, dtype=float32)] -- elapsed (train): 37.77s
Epoch = 3 / 5 (early stop in 5), step = 16, loss = 0.11413, results = [array(0.11413256, dtype=float32), array(0.9643765, dtype=float32)] -- elapsed (train): 40.64s
Epoch = 3 / 5 (early stop in 5), step = 32, loss = 0.11061, results = [array(0.11061248, dtype=float32), array(0.965625, dtype=float32)] -- elapsed (train): 43.54s
Epoch = 3 / 5 (early stop in 5), step = 48, loss = 0.10883, results = [array(0.10882916, dtype=float32), array(0.9664808, dtype=float32)] -- elapsed (train): 46.43s
Epoch = 4 / 5 (early stop in 5), step = 0, loss = 0.10603, results = [array(0.10602565, dtype=float32), array(0.96747327, dtype=float32)] -- elapsed (train): 49.35s
Epoch = 4 / 5 (early stop in 5), step = 14, loss = 0.10396, results = [array(0.10396387, dtype=float32), array(0.96817344, dtype=float32)] -- elapsed (train): 52.04s
Epoch = 4 / 5 (early stop in 5), step = 30, loss = 0.10215, results = [array(0.10215164, dtype=float32), array(0.96877724, dtype=float32)] -- elapsed (train): 54.95s
Epoch = 4 / 5 (early stop in 5), step = 46, loss = 0.10064, results = [array(0.10064323, dtype=float32), array(0.9693688, dtype=float32)] -- elapsed (train): 57.85s
Epoch = 4 / 5 (early stop in 5), step = 62, loss = 0.09953, results = [array(0.09952734, dtype=float32), array(0.9697786, dtype=float32)] -- elapsed (train): 60.75s
[1m7/7[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 110ms/step
Epoch 4 yielded predictions: (200,), overall balanced accuracy: 93.84%, TP = 15 / 17, TN = 182 / 183
train_results: [[array(0.7415254, dtype=float32), array(0.5, dtype=float32), 0, 0], [array(0.64031625, dtype=float32), array(0.59375, dtype=float32), 0.38757801055908203, 0], [array(0.78338224, dtype=float32), array(0.5625, dtype=float32), 0.5645608901977539, 0], [array(0.678399, dtype=float32), array(0.6425781, dtype=float32), 0.7527444362640381, 0], [array(0.63767225, dtype=float32), array(0.6703125, dtype=float32), 0.9515824317932129, 0], [array(0.6162664, dtype=float32), array(0.68880206, dtype=float32), 1.1643693447113037, 0], [array(0.55607307, dtype=float32), array(0.7254464, dtype=float32), 1.356985092163086, 0], [array(0.5099247, dtype=float32), array(0.7519531, dtype=float32), 1.5398709774017334, 0], [array(0.48840353, dtype=float32), array(0.7682292, dtype=float32), 1.721092700958252, 0], [array(0.48599547, dtype=float32), array(0.778125, dtype=float32), 1.8969933986663818, 0], [array(0.46713254, dtype=float32), array(0.78835225, dtype=float32), 2.0768215656280518, 0], [array(0.4401262, dtype=float32), array(0.80078125, dtype=float32), 2.247269868850708, 0], [array(0.4334933, dtype=float32), array(0.8082933, dtype=float32), 2.4250926971435547, 0], [array(0.42250744, dtype=float32), array(0.81584823, dtype=float32), 2.612257957458496, 0], [array(0.4103006, dtype=float32), array(0.8234375, dtype=float32), 2.7893776893615723, 0], [array(0.40055975, dtype=float32), array(0.8300781, dtype=float32), 3.040761947631836, 0], [array(0.38906467, dtype=float32), array(0.8350184, dtype=float32), 3.3445324897766113, 0], [array(0.3749099, dtype=float32), array(0.8428819, dtype=float32), 3.55517840385437, 0], [array(0.3625662, dtype=float32), array(0.8478618, dtype=float32), 3.7531211376190186, 0], [array(0.35029814, dtype=float32), array(0.8535156, dtype=float32), 3.9483985900878906, 0], [array(0.33769667, dtype=float32), array(0.85974705, dtype=float32), 4.323459148406982, 0], [array(0.3256097, dtype=float32), array(0.8650568, dtype=float32), 4.604455232620239, 0], [array(0.31718364, dtype=float32), array(0.8695652, dtype=float32), 4.87169885635376, 0], [array(0.30817112, dtype=float32), array(0.87402344, dtype=float32), 5.127320051193237, 0], [array(0.30144116, dtype=float32), array(0.8775, dtype=float32), 5.340027570724487, 0], [array(0.29323304, dtype=float32), array(0.8813101, dtype=float32), 5.546050786972046, 0], [array(0.285829, dtype=float32), array(0.8842593, dtype=float32), 5.76314902305603, 0], [array(0.28390765, dtype=float32), array(0.8858817, dtype=float32), 6.025827407836914, 0], [array(0.27743882, dtype=float32), array(0.88900864, dtype=float32), 6.2468626499176025, 0], [array(0.28017786, dtype=float32), array(0.88958335, dtype=float32), 6.471170425415039, 0], [array(0.27379325, dtype=float32), array(0.8923891, dtype=float32), 6.683003902435303, 0], [array(0.26911122, dtype=float32), array(0.89453125, dtype=float32), 6.911167621612549, 0], [array(0.26280838, dtype=float32), array(0.8972538, dtype=float32), 7.133336067199707, 0], [array(0.2583985, dtype=float32), array(0.8995864, dtype=float32), 7.33250617980957, 0], [array(0.2548883, dtype=float32), array(0.90089285, dtype=float32), 7.5286338329315186, 0], [array(0.25032413, dtype=float32), array(0.9027778, dtype=float32), 7.717868328094482, 0], [array(0.24748753, dtype=float32), array(0.9041385, dtype=float32), 7.907477617263794, 0], [array(0.24356973, dtype=float32), array(0.9056332, dtype=float32), 8.089121103286743, 0], [array(0.23893376, dtype=float32), array(0.90765226, dtype=float32), 8.277249097824097, 0], [array(0.23754665, dtype=float32), array(0.9085938, dtype=float32), 8.455757856369019, 0], [array(0.23344733, dtype=float32), array(0.9102515, dtype=float32), 8.63779878616333, 0], [array(0.22965556, dtype=float32), array(0.91183037, dtype=float32), 8.859299421310425, 0], [array(0.22565828, dtype=float32), array(0.9135174, dtype=float32), 9.087809324264526, 0], [array(0.22370599, dtype=float32), array(0.9145952, dtype=float32), 9.303716659545898, 0], [array(0.22002918, dtype=float32), array(0.91614586, dtype=float32), 9.535959959030151, 0], [array(
type(train_results): <class 'list'>
eval_results:    epoch   P    N  pred_P  pred_N  TP  FP   TN  FN   bal_acc        f1
0      4  17  183      16     184  15   1  182   2  0.938444  0.909091
type(eval_results): <class 'pandas.core.frame.DataFrame'>

Traceback (most recent call last):
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\mainoriginal.py", line 115, in <module>
    "final_train_loss": train_results["loss"],  # Asumiendo que train_results tiene 'loss'
                        ~~~~~~~~~~~~~^^^^^^^^
TypeError: list indices must be integers or slices, not str
