WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tf_keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

All model checkpoint layers were used when initializing TFDebertaModel.

All the layers of TFDebertaModel were initialized from the model checkpoint at microsoft/deberta-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDebertaModel for predictions without further training.
All model checkpoint layers were used when initializing TFDebertaModel.

All the layers of TFDebertaModel were initialized from the model checkpoint at microsoft/deberta-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDebertaModel for predictions without further training.
Using cache file path: cache\CSE_CIC_IDS_1300_QdLmZHuh8yOmlGcKBEkf7hepImY0_9Xii0x0FeiUOoDMwEgiWksBPgKc0.feather
Attempting to read dataset from path C:\Users\lapla\Downloads\b3427ed8ad063a09_MOHANAD_A4706\b3427ed8ad063a09_MOHANAD_A4706\data\NF-CSE-CIC-IDS2018-v2.csv...
Set y to = Attack
Converting numerical columns to floats, and removing out of range values...
Applying pre-processing to numerical values
[Numerical 1 / 28] Processing numerical column OUT_BYTES...
[Numerical 2 / 28] Processing numerical column RETRANSMITTED_IN_PKTS...
[Numerical 3 / 28] Processing numerical column RETRANSMITTED_OUT_BYTES...
[Numerical 4 / 28] Processing numerical column MAX_IP_PKT_LEN...
[Numerical 5 / 28] Processing numerical column SHORTEST_FLOW_PKT...
[Numerical 6 / 28] Processing numerical column FLOW_DURATION_MILLISECONDS...
[Numerical 7 / 28] Processing numerical column MIN_IP_PKT_LEN...
[Numerical 8 / 28] Processing numerical column TCP_WIN_MAX_IN...
[Numerical 9 / 28] Processing numerical column LONGEST_FLOW_PKT...
[Numerical 10 / 28] Processing numerical column IN_PKTS...
[Numerical 11 / 28] Processing numerical column MIN_TTL...
[Numerical 12 / 28] Processing numerical column DURATION_OUT...
[Numerical 13 / 28] Processing numerical column SRC_TO_DST_SECOND_BYTES...
[Numerical 14 / 28] Processing numerical column NUM_PKTS_256_TO_512_BYTES...
[Numerical 15 / 28] Processing numerical column DST_TO_SRC_SECOND_BYTES...
[Numerical 16 / 28] Processing numerical column MAX_TTL...
[Numerical 17 / 28] Processing numerical column NUM_PKTS_512_TO_1024_BYTES...
[Numerical 18 / 28] Processing numerical column NUM_PKTS_128_TO_256_BYTES...
[Numerical 19 / 28] Processing numerical column IN_BYTES...
[Numerical 20 / 28] Processing numerical column NUM_PKTS_1024_TO_1514_BYTES...
[Numerical 21 / 28] Processing numerical column OUT_PKTS...
[Numerical 22 / 28] Processing numerical column DST_TO_SRC_AVG_THROUGHPUT...
[Numerical 23 / 28] Processing numerical column NUM_PKTS_UP_TO_128_BYTES...
[Numerical 24 / 28] Processing numerical column DURATION_IN...
[Numerical 25 / 28] Processing numerical column RETRANSMITTED_IN_BYTES...
[Numerical 26 / 28] Processing numerical column SRC_TO_DST_AVG_THROUGHPUT...
[Numerical 27 / 28] Processing numerical column RETRANSMITTED_OUT_PKTS...
[Numerical 28 / 28] Processing numerical column TCP_WIN_MAX_OUT...
Applying pre-processing to categorical values
[Categorical 1 / 9] Processing categorical column CLIENT_TCP_FLAGS...
Encoding the 20 levels for CLIENT_TCP_FLAGS
[Categorical 2 / 9] Processing categorical column L4_SRC_PORT...
Encoding the 32 levels for L4_SRC_PORT
[Categorical 3 / 9] Processing categorical column TCP_FLAGS...
Encoding the 17 levels for TCP_FLAGS
[Categorical 4 / 9] Processing categorical column ICMP_IPV4_TYPE...
Encoding the 32 levels for ICMP_IPV4_TYPE
[Categorical 5 / 9] Processing categorical column ICMP_TYPE...
Encoding the 32 levels for ICMP_TYPE
[Categorical 6 / 9] Processing categorical column PROTOCOL...
Encoding the 2 levels for PROTOCOL
[Categorical 7 / 9] Processing categorical column SERVER_TCP_FLAGS...
Encoding the 17 levels for SERVER_TCP_FLAGS
[Categorical 8 / 9] Processing categorical column L4_DST_PORT...
Encoding the 32 levels for L4_DST_PORT
[Categorical 9 / 9] Processing categorical column L7_PROTO...
Encoding the 32 levels for L7_PROTO
Generating pre-processed dataframe...
Traceback (most recent call last):
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\main.py", line 77, in <module>
    ft.load_dataset(dataset_name, dataset_path, dataset_specification,  evaluation_dataset_sampling=eval_method, evaluation_percent=eval_percent, n_rows=1300)
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\framework\flow_transformer.py", line 341, in load_dataset
    df, model_input_spec = self._load_preprocessed_dataset(dataset_name, dataset, specification, cache_path, n_rows, evaluation_dataset_sampling, evaluation_percent, numerical_filter)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\framework\flow_transformer.py", line 291, in _load_preprocessed_dataset
    new_df = pd.DataFrame(flat_dict)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\internals\construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\construction.py", line 633, in sanitize_array
    return sanitize_array(
           ^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (1300, 20) instead
[0m
