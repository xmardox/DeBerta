Using cache file path: cache\CSE_CIC_IDS_8000_QdLmZHuh8yOmlGcKBEkf7hepImY0_arQKfKIcCZbIh1FZMjJp8Wf2BYc0.feather
Attempting to read dataset from path C:\Users\lapla\Downloads\b3427ed8ad063a09_MOHANAD_A4706\b3427ed8ad063a09_MOHANAD_A4706\data\NF-CSE-CIC-IDS2018-v2.csv...
Set y to = Attack
Converting numerical columns to floats, and removing out of range values...
Applying pre-processing to numerical values
[Numerical 1 / 28] Processing numerical column OUT_BYTES...
[Numerical 2 / 28] Processing numerical column RETRANSMITTED_IN_BYTES...
[Numerical 3 / 28] Processing numerical column NUM_PKTS_UP_TO_128_BYTES...
[Numerical 4 / 28] Processing numerical column DURATION_OUT...
[Numerical 5 / 28] Processing numerical column OUT_PKTS...
[Numerical 6 / 28] Processing numerical column FLOW_DURATION_MILLISECONDS...
[Numerical 7 / 28] Processing numerical column NUM_PKTS_1024_TO_1514_BYTES...
[Numerical 8 / 28] Processing numerical column RETRANSMITTED_OUT_BYTES...
[Numerical 9 / 28] Processing numerical column RETRANSMITTED_OUT_PKTS...
[Numerical 10 / 28] Processing numerical column MAX_IP_PKT_LEN...
[Numerical 11 / 28] Processing numerical column SRC_TO_DST_AVG_THROUGHPUT...
[Numerical 12 / 28] Processing numerical column IN_PKTS...
[Numerical 13 / 28] Processing numerical column NUM_PKTS_128_TO_256_BYTES...
[Numerical 14 / 28] Processing numerical column NUM_PKTS_256_TO_512_BYTES...
[Numerical 15 / 28] Processing numerical column DST_TO_SRC_AVG_THROUGHPUT...
[Numerical 16 / 28] Processing numerical column RETRANSMITTED_IN_PKTS...
[Numerical 17 / 28] Processing numerical column TCP_WIN_MAX_IN...
[Numerical 18 / 28] Processing numerical column SRC_TO_DST_SECOND_BYTES...
[Numerical 19 / 28] Processing numerical column NUM_PKTS_512_TO_1024_BYTES...
[Numerical 20 / 28] Processing numerical column MIN_TTL...
[Numerical 21 / 28] Processing numerical column IN_BYTES...
[Numerical 22 / 28] Processing numerical column DURATION_IN...
[Numerical 23 / 28] Processing numerical column SHORTEST_FLOW_PKT...
[Numerical 24 / 28] Processing numerical column TCP_WIN_MAX_OUT...
[Numerical 25 / 28] Processing numerical column LONGEST_FLOW_PKT...
[Numerical 26 / 28] Processing numerical column DST_TO_SRC_SECOND_BYTES...
[Numerical 27 / 28] Processing numerical column MIN_IP_PKT_LEN...
[Numerical 28 / 28] Processing numerical column MAX_TTL...
Applying pre-processing to categorical values
[Categorical 1 / 9] Processing categorical column CLIENT_TCP_FLAGS...
Encoding the 25 levels for CLIENT_TCP_FLAGS
[Categorical 2 / 9] Processing categorical column L4_SRC_PORT...
Encoding the 32 levels for L4_SRC_PORT
[Categorical 3 / 9] Processing categorical column TCP_FLAGS...
Encoding the 24 levels for TCP_FLAGS
[Categorical 4 / 9] Processing categorical column ICMP_IPV4_TYPE...
Encoding the 32 levels for ICMP_IPV4_TYPE
[Categorical 5 / 9] Processing categorical column ICMP_TYPE...
Encoding the 32 levels for ICMP_TYPE
[Categorical 6 / 9] Processing categorical column PROTOCOL...
Encoding the 4 levels for PROTOCOL
[Categorical 7 / 9] Processing categorical column SERVER_TCP_FLAGS...
Encoding the 23 levels for SERVER_TCP_FLAGS
[Categorical 8 / 9] Processing categorical column L4_DST_PORT...
Encoding the 32 levels for L4_DST_PORT
[Categorical 9 / 9] Processing categorical column L7_PROTO...
Encoding the 32 levels for L7_PROTO
Generating pre-processed dataframe...
Input data frame had shape (8000,45), output data frame has shape (8000,266) after pre-processing...
Writing to cache file path: cache\CSE_CIC_IDS_8000_QdLmZHuh8yOmlGcKBEkf7hepImY0_arQKfKIcCZbIh1FZMjJp8Wf2BYc0.feather...
c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\implementations\transformers\basic\encoder_block.py:74: UserWarning: Typically inner_dimension should be greater than or equal to the input_dimension!
  warnings.warn(f"Typically inner_dimension should be greater than or equal to the input_dimension!")
WARNING:tensorflow:From C:\Users\lapla\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\keras\src\backend\tensorflow\core.py:216: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
[1mModel: "functional"[0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1mLayer (type)                 [0m[1m [0m┃[1m [0m[1mOutput Shape             [0m[1m [0m┃[1m [0m[1m        Param #[0m[1m [0m┃[1m [0m[1mConnected to              [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_OUT_BYTES ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_BYTES  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_UP_TO_128_BYT… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_OUT            │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_OUT_PKTS ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_FLOW_DURATION_MILLISEC… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_1024_TO_1514_… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_OUT_PKTS  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MAX_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_PKTS ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_128_TO_256_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_256_TO_512_BY… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_AVG_THROUGH… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_RETRANSMITTED_IN_PKTS   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_IN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SRC_TO_DST_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_NUM_PKTS_512_TO_1024_B… │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_IN_BYTES ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DURATION_IN             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SHORTEST_FLOW_PKT       │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_WIN_MAX_OUT         │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_LONGEST_FLOW_PKT        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_DST_TO_SRC_SECOND_BYTES │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MIN_IP_PKT_LEN          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_MAX_TTL ([38;5;33mInputLayer[0m)    │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m1[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_CLIENT_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m25[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_SRC_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_TCP_FLAGS ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m24[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_IPV4_TYPE          │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_ICMP_TYPE ([38;5;33mInputLayer[0m)  │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_PROTOCOL ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m4[0m)              │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_SERVER_TCP_FLAGS        │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m23[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L4_DST_PORT             │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
│ ([38;5;33mInputLayer[0m)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ input_L7_PROTO ([38;5;33mInputLayer[0m)   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m32[0m)             │               [38;5;34m0[0m │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ concatenate ([38;5;33mConcatenate[0m)     │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m264[0m)            │               [38;5;34m0[0m │ input_OUT_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_RETRANSMITTED_IN_BY… │
│                               │                           │                 │ input_NUM_PKTS_UP_TO_128_… │
│                               │                           │                 │ input_DURATION_OUT[[38;5;34m0[0m][[38;5;34m0[0m],  │
│                               │                           │                 │ input_OUT_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_FLOW_DURATION_MILLI… │
│                               │                           │                 │ input_NUM_PKTS_1024_TO_15… │
│                               │                           │                 │ input_RETRANSMITTED_OUT_B… │
│                               │                           │                 │ input_RETRANSMITTED_OUT_P… │
│                               │                           │                 │ input_MAX_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_SRC_TO_DST_AVG_THRO… │
│                               │                           │                 │ input_IN_PKTS[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_NUM_PKTS_128_TO_256… │
│                               │                           │                 │ input_NUM_PKTS_256_TO_512… │
│                               │                           │                 │ input_DST_TO_SRC_AVG_THRO… │
│                               │                           │                 │ input_RETRANSMITTED_IN_PK… │
│                               │                           │                 │ input_TCP_WIN_MAX_IN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_SRC_TO_DST_SECOND_B… │
│                               │                           │                 │ input_NUM_PKTS_512_TO_102… │
│                               │                           │                 │ input_MIN_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_IN_BYTES[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_DURATION_IN[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_SHORTEST_FLOW_PKT[[38;5;34m0[0m… │
│                               │                           │                 │ input_TCP_WIN_MAX_OUT[[38;5;34m0[0m][[38;5;34m…[0m │
│                               │                           │                 │ input_LONGEST_FLOW_PKT[[38;5;34m0[0m]… │
│                               │                           │                 │ input_DST_TO_SRC_SECOND_B… │
│                               │                           │                 │ input_MIN_IP_PKT_LEN[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_MAX_TTL[[38;5;34m0[0m][[38;5;34m0[0m],       │
│                               │                           │                 │ input_CLIENT_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_SRC_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_TCP_FLAGS[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_ICMP_IPV4_TYPE[[38;5;34m0[0m][[38;5;34m0[0m… │
│                               │                           │                 │ input_ICMP_TYPE[[38;5;34m0[0m][[38;5;34m0[0m],     │
│                               │                           │                 │ input_PROTOCOL[[38;5;34m0[0m][[38;5;34m0[0m],      │
│                               │                           │                 │ input_SERVER_TCP_FLAGS[[38;5;34m0[0m]… │
│                               │                           │                 │ input_L4_DST_PORT[[38;5;34m0[0m][[38;5;34m0[0m],   │
│                               │                           │                 │ input_L7_PROTO[[38;5;34m0[0m][[38;5;34m0[0m]       │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_0_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m264[0m)            │         [38;5;34m340,400[0m │ concatenate[[38;5;34m0[0m][[38;5;34m0[0m]          │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ block_1_transformer_encoder   │ ([38;5;45mNone[0m, [38;5;34m8[0m, [38;5;34m264[0m)            │         [38;5;34m340,400[0m │ block_0_transformer_encod… │
│ ([38;5;33mTransformerEncoderBlock[0m)     │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ slice_last ([38;5;33mLambda[0m)           │ ([38;5;45mNone[0m, [38;5;34m264[0m)               │               [38;5;34m0[0m │ block_1_transformer_encod… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ classification_mlp_0_128      │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │          [38;5;34m33,920[0m │ slice_last[[38;5;34m0[0m][[38;5;34m0[0m]           │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout_2 ([38;5;33mDropout[0m)           │ ([38;5;45mNone[0m, [38;5;34m128[0m)               │               [38;5;34m0[0m │ classification_mlp_0_128[[38;5;34m…[0m │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ binary_classification_out     │ ([38;5;45mNone[0m, [38;5;34m1[0m)                 │             [38;5;34m129[0m │ dropout_2[[38;5;34m0[0m][[38;5;34m0[0m]            │
│ ([38;5;33mDense[0m)                       │                           │                 │                            │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
[1m Total params: [0m[38;5;34m714,849[0m (2.73 MB)
[1m Trainable params: [0m[38;5;34m714,849[0m (2.73 MB)
[1m Non-trainable params: [0m[38;5;34m0[0m (0.00 B)
Building eval dataset...
Splitting dataset to featurewise...
Evaluation dataset is built!
Positive samples in eval set: 22
Negative samples in eval set: 138
Epoch = 0 / 5 (early stop in 5), step = 0, loss = 0.74977, results = [array(0.7497748, dtype=float32), array(0.5078125, dtype=float32)] -- elapsed (train): 0.00s
Epoch = 0 / 5 (early stop in 5), step = 14, loss = 0.40064, results = [array(0.40064123, dtype=float32), array(0.82916665, dtype=float32)] -- elapsed (train): 2.86s
Epoch = 0 / 5 (early stop in 5), step = 28, loss = 0.29197, results = [array(0.291967, dtype=float32), array(0.88550645, dtype=float32)] -- elapsed (train): 5.69s
Epoch = 0 / 5 (early stop in 5), step = 43, loss = 0.23430, results = [array(0.23430401, dtype=float32), array(0.9128196, dtype=float32)] -- elapsed (train): 8.52s
Epoch = 0 / 5 (early stop in 5), step = 58, loss = 0.20215, results = [array(0.20215154, dtype=float32), array(0.9280985, dtype=float32)] -- elapsed (train): 11.38s
Epoch = 1 / 5 (early stop in 5), step = 8, loss = 0.18052, results = [array(0.18052466, dtype=float32), array(0.9368579, dtype=float32)] -- elapsed (train): 14.27s
Epoch = 1 / 5 (early stop in 5), step = 23, loss = 0.16552, results = [array(0.16552182, dtype=float32), array(0.9437145, dtype=float32)] -- elapsed (train): 17.11s
Epoch = 1 / 5 (early stop in 5), step = 38, loss = 0.15245, results = [array(0.15245019, dtype=float32), array(0.94910496, dtype=float32)] -- elapsed (train): 19.92s
Epoch = 1 / 5 (early stop in 5), step = 53, loss = 0.14242, results = [array(0.14241919, dtype=float32), array(0.953125, dtype=float32)] -- elapsed (train): 22.74s
Epoch = 2 / 5 (early stop in 5), step = 5, loss = 0.13224, results = [array(0.13223775, dtype=float32), array(0.95691466, dtype=float32)] -- elapsed (train): 25.70s
Epoch = 2 / 5 (early stop in 5), step = 21, loss = 0.12457, results = [array(0.12456632, dtype=float32), array(0.95979166, dtype=float32)] -- elapsed (train): 28.65s
Epoch = 2 / 5 (early stop in 5), step = 37, loss = 0.11902, results = [array(0.11901991, dtype=float32), array(0.962067, dtype=float32)] -- elapsed (train): 31.60s
Epoch = 2 / 5 (early stop in 5), step = 52, loss = 0.11428, results = [array(0.11428256, dtype=float32), array(0.9637431, dtype=float32)] -- elapsed (train): 34.40s
Epoch = 3 / 5 (early stop in 5), step = 4, loss = 0.10917, results = [array(0.10916919, dtype=float32), array(0.9654981, dtype=float32)] -- elapsed (train): 37.36s
Epoch = 3 / 5 (early stop in 5), step = 19, loss = 0.10505, results = [array(0.10504961, dtype=float32), array(0.9669811, dtype=float32)] -- elapsed (train): 40.15s
Epoch = 3 / 5 (early stop in 5), step = 35, loss = 0.10106, results = [array(0.10105612, dtype=float32), array(0.9681332, dtype=float32)] -- elapsed (train): 43.09s
Epoch = 3 / 5 (early stop in 5), step = 51, loss = 0.09811, results = [array(0.09810756, dtype=float32), array(0.9691342, dtype=float32)] -- elapsed (train): 46.03s
Epoch = 4 / 5 (early stop in 5), step = 1, loss = 0.09583, results = [array(0.09583154, dtype=float32), array(0.96977955, dtype=float32)] -- elapsed (train): 48.70s
Epoch = 4 / 5 (early stop in 5), step = 16, loss = 0.09373, results = [array(0.09372568, dtype=float32), array(0.97055286, dtype=float32)] -- elapsed (train): 51.49s
Epoch = 4 / 5 (early stop in 5), step = 31, loss = 0.09264, results = [array(0.09263711, dtype=float32), array(0.9708116, dtype=float32)] -- elapsed (train): 54.28s
Epoch = 4 / 5 (early stop in 5), step = 46, loss = 0.09237, results = [array(0.09236638, dtype=float32), array(0.9707611, dtype=float32)] -- elapsed (train): 57.21s
Epoch = 4 / 5 (early stop in 5), step = 61, loss = 0.09116, results = [array(0.09115847, dtype=float32), array(0.97128046, dtype=float32)] -- elapsed (train): 60.16s
[1m5/5[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 19ms/step 
Epoch 4 yielded predictions: (160,), overall balanced accuracy: 93.18%, TP = 19 / 22, TN = 138 / 138
train_results: [[array(0.7497748, dtype=float32), array(0.5078125, dtype=float32), 0, 0], [array(0.7832989, dtype=float32), array(0.5859375, dtype=float32), 0.41377782821655273, 0], [array(0.8111995, dtype=float32), array(0.5677083, dtype=float32), 0.6065459251403809, 0], [array(0.69663286, dtype=float32), array(0.6425781, dtype=float32), 0.794929027557373, 0], [array(0.6047244, dtype=float32), array(0.7, dtype=float32), 0.9884819984436035, 0], [array(0.57793087, dtype=float32), array(0.7213542, dtype=float32), 1.173006296157837, 0], [array(0.5546507, dtype=float32), array(0.73883927, dtype=float32), 1.353830337524414, 0], [array(0.51277983, dtype=float32), array(0.76171875, dtype=float32), 1.5347445011138916, 0], [array(0.49576828, dtype=float32), array(0.7734375, dtype=float32), 1.7330174446105957, 0], [array(0.4813447, dtype=float32), array(0.784375, dtype=float32), 1.9176321029663086, 0], [array(0.46550608, dtype=float32), array(0.7933239, dtype=float32), 2.117719888687134, 0], [array(0.44380164, dtype=float32), array(0.80533856, dtype=float32), 2.292416572570801, 0], [array(0.42617887, dtype=float32), array(0.8155048, dtype=float32), 2.475924253463745, 0], [array(0.41785976, dtype=float32), array(0.8197545, dtype=float32), 2.664904832839966, 0], [array(0.40064123, dtype=float32), array(0.82916665, dtype=float32), 2.8554887771606445, 0], [array(0.38804224, dtype=float32), array(0.8359375, dtype=float32), 3.0781126022338867, 0], [array(0.37194252, dtype=float32), array(0.8428309, dtype=float32), 3.2805421352386475, 0], [array(0.36280409, dtype=float32), array(0.8472222, dtype=float32), 3.473761558532715, 0], [array(0.35267127, dtype=float32), array(0.8527961, dtype=float32), 3.6657543182373047, 0], [array(0.34190577, dtype=float32), array(0.8582031, dtype=float32), 3.8560662269592285, 0], [array(0.3353267, dtype=float32), array(0.86160713, dtype=float32), 4.057875633239746, 0], [array(0.32885572, dtype=float32), array(0.8647017, dtype=float32), 4.264843463897705, 0], [array(0.323304, dtype=float32), array(0.8678669, dtype=float32), 4.463364124298096, 0], [array(0.31844774, dtype=float32), array(0.8701172, dtype=float32), 4.6574530601501465, 0], [array(0.31308258, dtype=float32), array(0.87375, dtype=float32), 4.846177339553833, 0], [array(0.30780017, dtype=float32), array(0.87680286, dtype=float32), 5.046611309051514, 0], [array(0.30276895, dtype=float32), array(0.879919, dtype=float32), 5.2553441524505615, 0], [array(0.29630876, dtype=float32), array(0.8833705, dtype=float32), 5.485896348953247, 0], [array(0.291967, dtype=float32), array(0.88550645, dtype=float32), 5.687099933624268, 0], [array(0.28577393, dtype=float32), array(0.8880208, dtype=float32), 5.886401653289795, 0], [array(0.27857092, dtype=float32), array(0.891129, dtype=float32), 6.08512806892395, 0], [array(0.2727412, dtype=float32), array(0.89331055, dtype=float32), 6.293309926986694, 0], [array(0.26841593, dtype=float32), array(0.89559656, dtype=float32), 6.488077402114868, 0], [array(0.26610312, dtype=float32), array(0.89682907, dtype=float32), 6.683117389678955, 0], [array(0.2642891, dtype=float32), array(0.8982143, dtype=float32), 6.874682664871216, 0], [array(0.25866085, dtype=float32), array(0.90060765, dtype=float32), 7.057006120681763, 0], [array(0.25689593, dtype=float32), array(0.902027, dtype=float32), 7.2479407787323, 0], [array(0.2543783, dtype=float32), array(0.9031661, dtype=float32), 7.429931640625, 0], [array(0.24981464, dtype=float32), array(0.9050481, dtype=float32), 7.613664627075195, 0], [array(0.24559426, dtype=float32), array(0.9068359, dtype=float32), 7.794569492340088, 0], [array(0.24139863, dtype=float32), array(0.9087271, dtype=float32), 7.981593132019043, 0], [array(0.2380615, dtype=float32), array(0.9103423, dtype=float32), 8.160600900650024, 0], [array(0.23462059, dtype=float32), array(0.91206396, dtype=float32), 8.337338924407959, 0], [array(0.23430401, dtype=float32), array(0.9128196, dtype=float32), 8.523990631103516, 0], [array(0.23224224, dtype=float32), array(0.9140625, dtype=float32), 8.712453842163086, 0], [array(0
eval_results:    epoch   P    N  pred_P  pred_N  TP  FP   TN  FN   bal_acc        f1
0      4  22  138      19     141  19   0  138   3  0.931818  0.926829
eval_results head:
    epoch   P    N  pred_P  pred_N  TP  FP   TN  FN   bal_acc        f1
0      4  22  138      19     141  19   0  138   3  0.931818  0.926829

Traceback (most recent call last):
  File "c:\Users\lapla\Downloads\FlowTransformer-master\FlowTransformer-master\mainoriginal.py", line 97, in <module>
    final_train_loss = train_results[0]["loss"]  # Ajusta según la estructura de 'train_results'
                       ~~~~~~~~~~~~~~~~^^^^^^^^
TypeError: list indices must be integers or slices, not str
